"use strict";

define([], function () {
  var Tester = function Tester() {
    this.init.apply(this, arguments);
  };

  Tester.prototype = {
    init: function init(params) {
      this.fails = 0;
      this.preTestTasks = params.preTestTasks || [];
      this.postTestTasks = params.postTestTasks || [];
    },
    heading: function heading(title) {
      console.log('==', title, '==');
    },
    assert: function assert(condition, msg) {
      if (condition) {
        console.log('[ok  ]', msg);
      } else {
        console.log('[fail]', msg);
        this.fails++;
      }
    },
    assertEquals: function assertEquals(real, expected, msg) {
      msg = msg || '';
      this.assert(real === expected, msg + ' -> real:' + real + ' expected:' + expected);
    },
    assertEqualsList: function assertEqualsList(real, expected, msg) {
      msg = msg || '';

      if (real.length !== expected.length) {
        this.assert(false, msg + '-> lengths not equals real:' + JSON.stringify(real) + ' real-length:' + real.length + ' expected:' + JSON.stringify(expected) + ' expexcted-length:' + expected.length);
        return;
      }

      for (var i = 0; i < real.length; ++i) {
        var r = real[i];
        var e = expected[i];

        if (r !== e) {
          this.assert(false, msg + ' -> elements with index ' + i + ' differ real:' + JSON.stringify(real) + ' real-element:' + r + ' expected:' + JSON.stringify(expected) + ' expected-element:' + e);
          return;
        }
      }

      return this.assert(true, msg);
    },
    result: function result() {
      if (this.fails > 0) {
        console.log('==> FAILED:' + this.fails);
      } else {
        console.log('==> OK');
      }
    },
    registerPreTestTask: function registerPreTestTask(task) {
      this.preTestTasks.push(task);
    },
    registerPostTestTask: function registerPostTestTask(task) {
      this.postTestTasks.push(task);
    },
    run: function run(test) {
      if (test.skip) {
        return;
      }

      this.heading(test.label);

      for (var i = 0; i < this.preTestTasks.length; ++i) {
        var preTestTask = this.preTestTasks[i];
        preTestTask();
      }

      test.execute(this);

      for (var j = 0; j < this.postTestTasks.length; ++j) {
        var postTestTask = this.postTestTasks[j];
        postTestTask();
      }
    },
    runTestCases: function runTestCases(testCases) {
      for (var testCaseName in testCases) {
        var testCase = testCases[testCaseName];
        this.run(testCase);
      }
    }
  };
  return Tester;
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3Rlc3QvVGVzdGVyLmpzIl0sIm5hbWVzIjpbImRlZmluZSIsIlRlc3RlciIsImluaXQiLCJhcHBseSIsImFyZ3VtZW50cyIsInByb3RvdHlwZSIsInBhcmFtcyIsImZhaWxzIiwicHJlVGVzdFRhc2tzIiwicG9zdFRlc3RUYXNrcyIsImhlYWRpbmciLCJ0aXRsZSIsImNvbnNvbGUiLCJsb2ciLCJhc3NlcnQiLCJjb25kaXRpb24iLCJtc2ciLCJhc3NlcnRFcXVhbHMiLCJyZWFsIiwiZXhwZWN0ZWQiLCJhc3NlcnRFcXVhbHNMaXN0IiwibGVuZ3RoIiwiSlNPTiIsInN0cmluZ2lmeSIsImkiLCJyIiwiZSIsInJlc3VsdCIsInJlZ2lzdGVyUHJlVGVzdFRhc2siLCJ0YXNrIiwicHVzaCIsInJlZ2lzdGVyUG9zdFRlc3RUYXNrIiwicnVuIiwidGVzdCIsInNraXAiLCJsYWJlbCIsInByZVRlc3RUYXNrIiwiZXhlY3V0ZSIsImoiLCJwb3N0VGVzdFRhc2siLCJydW5UZXN0Q2FzZXMiLCJ0ZXN0Q2FzZXMiLCJ0ZXN0Q2FzZU5hbWUiLCJ0ZXN0Q2FzZSJdLCJtYXBwaW5ncyI6Ijs7QUFBQUEsTUFBTSxDQUFDLEVBQUQsRUFBSyxZQUFZO0FBRW5CLE1BQUlDLE1BQU0sR0FBRyxTQUFUQSxNQUFTLEdBQVk7QUFDckIsU0FBS0MsSUFBTCxDQUFVQyxLQUFWLENBQWdCLElBQWhCLEVBQXNCQyxTQUF0QjtBQUNILEdBRkQ7O0FBSUFILEVBQUFBLE1BQU0sQ0FBQ0ksU0FBUCxHQUFtQjtBQUVmSCxJQUFBQSxJQUFJLEVBQUUsY0FBVUksTUFBVixFQUFrQjtBQUNwQixXQUFLQyxLQUFMLEdBQWEsQ0FBYjtBQUNBLFdBQUtDLFlBQUwsR0FBb0JGLE1BQU0sQ0FBQ0UsWUFBUCxJQUF1QixFQUEzQztBQUNBLFdBQUtDLGFBQUwsR0FBcUJILE1BQU0sQ0FBQ0csYUFBUCxJQUF3QixFQUE3QztBQUNILEtBTmM7QUFRZkMsSUFBQUEsT0FBTyxFQUFFLGlCQUFVQyxLQUFW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LEtBekRjO0FBMkRmRyxJQUFBQSxHQUFHLEVBQUUsYUFBVUMsSUFBVixFQUFnQjtBQUNqQixVQUFJQSxJQUFJLENBQUNDLElBQVQsRUFBZTtBQUNYO0FBQ0g7O0FBQ0QsV0FBS3hCLE9BQUwsQ0FBYXVCLElBQUksQ0FBQ0UsS0FBbEI7O0FBQ0EsV0FBSyxJQUFJWCxDQUFDLEdBQUcsQ0FBYixFQUFnQkEsQ0FBQyxHQUFHLEtBQUtoQixZQUFMLENBQWtCYSxNQUF0QyxFQUE4QyxFQUFFRyxDQUFoRCxFQUFtRDtBQUMvQyxZQUFJWSxXQUFXLEdBQUcsS0FBSzVCLFlBQUwsQ0FBa0JnQixDQUFsQixDQUFsQjtBQUNBWSxRQUFBQSxXQUFXO0FBQ2Q7O0FBQ0RILE1BQUFBLElBQUksQ0FBQ0ksT0FBTCxDQUFhLElBQWI7O0FBQ0EsV0FBSyxJQUFJQyxDQUFDLEdBQUcsQ0FBYixFQUFnQkEsQ0FBQyxHQUFHLEtBQUs3QixhQUFMLENBQW1CWSxNQUF2QyxFQUErQyxFQUFFaUIsQ0FBakQsRUFBb0Q7QUFDaEQsWUFBSUMsWUFBWSxHQUFHLEtBQUs5QixhQUFMLENBQW1CNkIsQ0FBbkIsQ0FBbkI7QUFDQUMsUUFBQUEsWUFBWTtBQUNmO0FBQ0osS0F6RWM7QUEyRWZDLElBQUFBLFlBQVksRUFBRSxzQkFBVUMsU0FBVixFQUFxQjtBQUMvQixXQUFLLElBQUlDLFlBQVQsSUFBeUJELFNBQXpCLEVBQW9DO0FBQ2hDLFlBQUlFLFFBQVEsR0FBR0YsU0FBUyxDQUFDQyxZQUFELENBQXhCO0FBQ0EsYUFBS1YsR0FBTCxDQUFTVyxRQUFUO0FBQ0g7QUFDSjtBQWhGYyxHQUFuQjtBQW9GQSxTQUFPMUMsTUFBUDtBQUVILENBNUZLLENBQU4iLCJzb3VyY2VzQ29udGVudCI6WyJkZWZpbmUoW10sIGZ1bmN0aW9uICgpIHtcblxuICAgIHZhciBUZXN0ZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuaW5pdC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgIH1cblxuICAgIFRlc3Rlci5wcm90b3R5cGUgPSB7XG5cbiAgICAgICAgaW5pdDogZnVuY3Rpb24gKHBhcmFtcykge1xuICAgICAgICAgICAgdGhpcy5mYWlscyA9IDA7XG4gICAgICAgICAgICB0aGlzLnByZVRlc3RUYXNrcyA9IHBhcmFtcy5wcmVUZXN0VGFza3MgfHwgW107XG4gICAgICAgICAgICB0aGlzLnBvc3RUZXN0VGFza3MgPSBwYXJhbXMucG9zdFRlc3RUYXNrcyB8fCBbXTtcbiAgICAgICAgfSxcblxuICAgICAgICBoZWFkaW5nOiBmdW5jdGlvbiAodGl0bGUpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCc9PScsIHRpdGxlLCAnPT0nKTtcbiAgICAgICAgfSxcblxuICAgICAgICBhc3NlcnQ6IGZ1bmN0aW9uIChjb25kaXRpb24sIG1zZykge1xuICAgICAgICAgICAgaWYgKGNvbmRpdGlvbikge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdbb2sgIF0nLCBtc2cpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnW2ZhaWxdJywgbXNnKTtcbiAgICAgICAgICAgICAgICB0aGlzLmZhaWxzKys7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG5cbiAgICAgICAgYXNzZXJ0RXF1YWxzOiBmdW5jdGlvbiAocmVhbCwgZXhwZWN0ZWQsIG1zZykge1xuICAgICAgICAgICAgbXNnID0gbXNnIHx8ICcnO1xuICAgICAgICAgICAgdGhpcy5hc3NlcnQocmVhbCA9PT0gZXhwZWN0ZWQsIG1zZyArICcgLT4gcmVhbDonICsgcmVhbCArICcgZXhwZWN0ZWQ6JyArIGV4cGVjdGVkKTtcbiAgICAgICAgfSxcblxuICAgICAgICBhc3NlcnRFcXVhbHNMaXN0OiBmdW5jdGlvbiAocmVhbCwgZXhwZWN0ZWQsIG1zZykge1xuICAgICAgICAgICAgbXNnID0gbXNnIHx8ICcnO1xuICAgICAgICAgICAgaWYgKHJlYWwubGVuZ3RoICE9PSBleHBlY3RlZC5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmFzc2VydChmYWxzZSwgbXNnICsgJy0+IGxlbmd0aHMgbm90IGVxdWFscyByZWFsOicgKyBKU09OLnN0cmluZ2lmeShyZWFsKSArICcgcmVhbC1sZW5ndGg6JyArIHJlYWwubGVuZ3RoICsgJyBleHBlY3RlZDonICsgSlNPTi5zdHJpbmdpZnkoZXhwZWN0ZWQpICsgJyBleHBleGN0ZWQtbGVuZ3RoOicgKyBleHBlY3RlZC5sZW5ndGgpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcmVhbC5sZW5ndGg7ICsraSkge1xuICAgICAgICAgICAgICAgIHZhciByID0gcmVhbFtpXTtcbiAgICAgICAgICAgICAgICB2YXIgZSA9IGV4cGVjdGVkW2ldO1xuICAgICAgICAgICAgICAgIGlmIChyICE9PSBlKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYXNzZXJ0KGZhbHNlLCBtc2cgKyAnIC0+IGVsZW1lbnRzIHdpdGggaW5kZXggJyArIGkgKyAnIGRpZmZlciByZWFsOicgKyBKU09OLnN0cmluZ2lmeShyZWFsKSArICcgcmVhbC1lbGVtZW50OicgKyByICsgJyBleHBlY3RlZDonICsgSlNPTi5zdHJpbmdpZnkoZXhwZWN0ZWQpICsgJyBleHBlY3RlZC1lbGVtZW50OicgKyBlKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB0aGlzLmFzc2VydCh0cnVlLCBtc2cpO1xuICAgICAgICB9LFxuXG4gICAgICAgIHJlc3VsdDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaWYgKHRoaXMuZmFpbHMgPiAwKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJz09PiBGQUlMRUQ6JyArIHRoaXMuZmFpbHMpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnPT0+IE9LJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG5cbiAgICAgICAgcmVnaXN0ZXJQcmVUZXN0VGFzazogZnVuY3Rpb24gKHRhc2spIHtcbiAgICAgICAgICAgIHRoaXMucHJlVGVzdFRhc2tzLnB1c2godGFzayk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgcmVnaXN0ZXJQb3N0VGVzdFRhc2s6IGZ1bmN0aW9uICh0YXNrKSB7XG4gICAgICAgICAgICB0aGlzLnBvc3RUZXN0VGFza3MucHVzaCh0YXNrKTtcbiAgICAgICAgfSxcblxuICAgICAgICBydW46IGZ1bmN0aW9uICh0ZXN0KSB7XG4gICAgICAgICAgICBpZiAodGVzdC5za2lwKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5oZWFkaW5nKHRlc3QubGFiZWwpO1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLnByZVRlc3RUYXNrcy5sZW5ndGg7ICsraSkge1xuICAgICAgICAgICAgICAgIHZhciBwcmVUZXN0VGFzayA9IHRoaXMucHJlVGVzdFRhc2tzW2ldO1xuICAgICAgICAgICAgICAgIHByZVRlc3RUYXNrKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0ZXN0LmV4ZWN1dGUodGhpcyk7XG4gICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IHRoaXMucG9zdFRlc3RUYXNrcy5sZW5ndGg7ICsraikge1xuICAgICAgICAgICAgICAgIHZhciBwb3N0VGVzdFRhc2sgPSB0aGlzLnBvc3RUZXN0VGFza3Nbal07XG4gICAgICAgICAgICAgICAgcG9zdFRlc3RUYXNrKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG5cbiAgICAgICAgcnVuVGVzdENhc2VzOiBmdW5jdGlvbiAodGVzdENhc2VzKSB7XG4gICAgICAgICAgICBmb3IgKHZhciB0ZXN0Q2FzZU5hbWUgaW4gdGVzdENhc2VzKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRlc3RDYXNlID0gdGVzdENhc2VzW3Rlc3RDYXNlTmFtZV07XG4gICAgICAgICAgICAgICAgdGhpcy5ydW4odGVzdENhc2UpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICB9O1xuXG4gICAgcmV0dXJuIFRlc3RlcjtcblxufSk7Il19