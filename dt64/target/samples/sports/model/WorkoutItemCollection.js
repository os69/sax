"use strict";

define(['../../../src/index', './Object', './WorkoutItem'], function (tt, Object, WorkoutItem) {
  var WorkoutItemCollection = tt.core.defineDerivedClass(Object, {
    init: function init(params) {
      params.name = params.name || '';
      Object.prototype.init.apply(this, arguments);
      this.items = params.items || [];
      this.postDeSerialize();
    },
    postDeSerialize: function postDeSerialize() {
      tt.createReducedListProperty(this, 'checked', this.items, function (accu, item) {
        if (!accu || !item.getChecked()) {
          return false;
        } else {
          return true;
        }
      }.bind(this), true);
      tt.createReducedListProperty(this, 'totalDuration', this.items, function (accu, item) {
        return accu + item.getTotalDuration();
      }.bind(this), 0);
      tt.createReducedListProperty(this, 'elapsed', this.items, function (accu, item) {
        return accu + item.getElapsed();
      }.bind(this), 0);
    },
    delete: function _delete() {
      if (!Object.prototype.delete.apply(this, arguments)) {
        return false;
      }

      for (var i = 0; i < this.items.length; ++i) {
        var item = this.items[i];
        item.delete();
      }

      tt.core.removeObject(this.parent.items, this);
      return true;
    },
    deepClone: function deepClone() {
      var clonedItemCollection = new WorkoutItemCollection({
        name: this.name
      });

      for (var i = 0; i < this.items.length; ++i) {
        var item = this.items[i];
        var clonedItem = item.deepClone();
        clonedItem.parent = clonedItemCollection;
        clonedItemCollection.items.push(clonedItem);
      }

      return clonedItemCollection;
    },
    createItem: function createItem(params) {
      params.parent = this;
      var item = new WorkoutItem(params);
      this.items.push(item);
      return item;
    },
    createItemCollection: function createItemCollection(params) {
      params.parent = this;
      var itemCollection = new WorkoutItemCollection(params);
      this.items.push(itemCollection);
      return itemCollection;
    },
    insertBefore: function insertBefore(item) {
      if (item === this) {
        return;
      }

      var oldParent = item.parent;
      tt.core.removeObject(oldParent.items, item);
      item.parent = this.parent;
      var index = this.parent.items.indexOf(this);
      this.parent.items.splice(index, 0, item);
    },
    insertCloneBefore: function insertCloneBefore(item) {
      var clonedWorkoutItem = item.deepClone();
      clonedWorkoutItem.parent = this.parent;
      var index = this.parent.items.indexOf(this);
      this.parent.items.splice(index, 0, clonedWorkoutItem);
    }
  });
  return WorkoutItemCollection;
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3NhbXBsZXMvc3BvcnRzL21vZGVsL1dvcmtvdXRJdGVtQ29sbGVjdGlvbi5qcyJdLCJuYW1lcyI6WyJkZWZpbmUiLCJ0dCIsIk9iamVjdCIsIldvcmtvdXRJdGVtIiwiV29ya291dEl0ZW1Db2xsZWN0aW9uIiwiY29yZSIsImRlZmluZURlcml2ZWRDbGFzcyIsImluaXQiLCJwYXJhbXMiLCJuYW1lIiwicHJvdG90eXBlIiwiYXBwbHkiLCJhcmd1bWVudHMiLCJpdGVtcyIsInBvc3REZVNlcmlhbGl6ZSIsImNyZWF0ZVJlZHVjZWRMaXN0UHJvcGVydHkiLCJhY2N1IiwiaXRlbSIsImdldENoZWNrZWQiLCJiaW5kIiwiZ2V0VG90YWxEdXJhdGlvbiIsImdldEVsYXBzZWQiLCJkZWxldGUiLCJpIiwibGVuZ3RoIiwicmVtb3ZlT2JqZWN0IiwicGFyZW50IiwiZGVlcENsb25lIiwiY2xvbmVkSXRlbUNvbGxlY3Rpb24iLCJjbG9uZWRJdGVtIiwicHVzaCIsImNyZWF0ZUl0ZW0iLCJjcmVhdGVJdGVtQ29sbGVjdGlvbiIsIml0ZW1Db2xsZWN0aW9uIiwiaW5zZXJ0QmVmb3JlIiwib2xkUGFyZW50IiwiaW5kZXgiLCJpbmRleE9mIiwic3BsaWNlIiwiaW5zZXJ0Q2xvbmVCZWZvcmUiLCJjbG9uZWRXb3Jrb3V0SXRlbSJdLCJtYXBwaW5ncyI6Ijs7QUFBQUEsTUFBTSxDQUFDLENBQUMsb0JBQUQsRUFBdUIsVUFBdkIsRUFBbUMsZUFBbkMsQ0FBRCxFQUFzRCxVQUFVQyxFQUFWLEVBQWNDLE1BQWQsRUFBc0JDLFdBQXRCLEVBQW1DO0FBRTNGLE1BQUlDLHFCQUFxQixHQUFHSCxFQUFFLENBQUNJLElBQUgsQ0FBUUMsa0JBQVIsQ0FBMkJKLE1BQTNCLEVBQW1DO0FBRTNESyxJQUFBQSxJQUFJLEVBQUUsY0FBVUMsTUFBVixFQUFrQjtBQUNwQkEsTUFBQUEsTUFBTSxDQUFDQyxJQUFQLEdBQWNELE1BQU0sQ0FBQ0MsSUFBUCxJQUFlLEVBQTdCO0FBQ0FQLE1BQUFBLE1BQU0sQ0FBQ1EsU0FBUCxDQUFpQkgsSUFBakIsQ0FBc0JJLEtBQXRCLENBQTRCLElBQTVCLEVBQWtDQyxTQUFsQztBQUNBLFdBQUtDLEtBQUwsR0FBYUwsTUFBTSxDQUFDSyxLQUFQLElBQWdCLEVBQTdCO0FBQ0EsV0FBS0MsZUFBTDtBQUNILEtBUDBEO0FBUzNEQSxJQUFBQSxlQUFlLEVBQUUsMkJBQVk7QUFDekJiLE1BQUFBLEVBQUUsQ0FBQ2MseUJBQUgsQ0FBNkIsSUFBN0IsRUFBbUMsU0FBbkMsRUFBOEMsS0FBS0YsS0FBbkQsRUFBMEQsVUFBVUcsSUFBVixFQUFnQkMsSUFBaEIsRUFBc0I7QUFDNUUsWUFBSSxDQUFDRCxJQUFELElBQVMsQ0FBQ0MsSUFBSSxDQUFDQyxVQUFMLEVBQWQsRUFBaUM7QUFDN0IsaUJBQU8sS0FBUDtBQUNILFNBRkQsTUFFTztBQUNILGlCQUFPLElBQVA7QUFDSDtBQUNKLE9BTnlELENBTXhEQyxJQU53RCxDQU1uRCxJQU5tRCxDQUExRCxFQU1jLElBTmQ7QUFPQWxCLE1BQUFBLEVBQUUsQ0FBQ2MseUJBQUgsQ0FBNkIsSUFBN0IsRUFBbUMsZUFBbkMsRUFBb0QsS0FBS0YsS0FBekQsRUFBZ0UsVUFBVUcsSUFBVixFQUFnQkMsSUFBaEIsRUFBc0I7QUFDbEYsZUFBT0QsSUFBSSxHQUFHQyxJQUFJLENBQUNHLGdCQUFMLEVBQWQ7QUFDSCxPQUYrRCxDQUU5REQsSUFGOEQsQ0FFekQsSUFGeUQsQ0FBaEUsRUFFYyxDQUZkO0FBR0FsQixNQUFBQSxFQUFFLENBQUNjLHlCQUFILENBQTZCLElBQTdCLEVBQW1DLFNBQW5DLEVBQThDLEtBQUtGLEtBQW5ELEVBQTBELFVBQVVHLElBQVYsRUFBZ0JDLElBQWhCLEVBQXNCO0FBQzVFLGVBQU9ELElBQUksR0FBR0MsSUFBSSxDQUFDSSxVQUFMLEVBQWQ7QUFDSCxPQUZ5RCxDQUV4REYsSUFGd0QsQ0FFbkQsSUFGbUQsQ0FBMUQsRUFFYyxDQUZkO0FBR0gsS0F2QjBEO0FBeUIzREcsSUFBQUEsTUFBTSxFQUFFLG1CQUFZO0FBQ2hCLFVBQUksQ0FBQ3BCLE1BQU0sQ0FBQ1EsU0FBUCxDQUFpQlksTUFBakIsQ0FBd0JYLEtBQXhCLENBQThCLElBQTlCLEVBQW9DQyxTQUFwQyxDQUFMLEVBQXFEO0FBQ2pELGVBQU8sS0FBUDtBQUNIOztBQUNELFdBQUssSUFBSVcsQ0FBQyxHQUFHLENBQWIsRUFBZ0JBLENBQUMsR0FBRyxLQUFLVixLQUFMLENBQVdXLE1BQS9CLEVBQXVDLEVBQUVELENBQXpDLEVBQTRDO0FBQ3hDLFlBQUlOLElBQUksR0FBRyxLQUFLSixLQUFMLENBQVdVLENBQVgsQ0FBWDtBQUNBTixRQUFBQSxJQUFJLENBQUNLLE1BQUw7QUFDSDs7QUFDRHJCLE1BQUFBLEVBQUUsQ0FBQ0ksSUFBSCxDQUFRb0IsWUFBUixDQUFxQixLQUFLQyxNQUFMLENBQVliLEtBQWpDLEVBQXdDLElBQXhDO0FBQ0EsYUFBTyxJQUFQO0FBQ0gsS0FuQzBEO0FBcUMzRGMsSUFBQUEsU0FBUyxFQUFFLHFCQUFZO0FBQ25CLFVBQUlDLG9CQUFvQixHQUFHLElBQUl4QixxQkFBSixDQUEwQjtBQUNqREssUUFBQUEsSUFBSSxFQUFFLEtBQUtBO0FBRHNDLE9BQTFCLENBQTNCOztBQUdBLFdBQUssSUFBSWMsQ0FBQyxHQUFHLENBQWIsRUFBZ0JBLENBQUMsR0FBRyxLQUFLVixLQUFMLENBQVdXLE1BQS9CLEVBQXVDLEVBQUVELENBQXpDLEVBQTRDO0FBQ3hDLFlBQUlOLElBQUksR0FBRyxLQUFLSixLQUFMLENBQVdVLENBQVgsQ0FBWDtBQUNBLFlBQUlNLFVBQVUsR0FBR1osSUFBSSxDQUFDVSxTQUFMLEVBQWpCO0FBQ0FFLFFBQUFBLFVBQVUsQ0FBQ0gsTUFBWCxHQUFvQkUsb0JBQXBCO0FBQ0FBLFFBQUFBLG9CQUFvQixDQUFDZixLQUFyQixDQUEyQmlCLElBQTNCLENBQWdDRCxVQUFoQztBQUNIOztBQUNELGFBQU9ELG9CQUFQO0FBQ0gsS0FoRDBEO0FBa0QzREcsSUFBQUEsVUFBVSxFQUFFLG9CQUFVdkIsTUFBVixFQUFrQjtBQUMxQkEsTUFBQUEsTUFBTSxDQUFDa0IsTUFBUCxHQUFnQixJQUFoQjtBQUNBLFVBQUlULElBQUksR0FBRyxJQUFJZCxXQUFKLENBQWdCSyxNQUFoQixDQUFYO0FBQ0EsV0FBS0ssS0FBTCxDQUFXaUIsSUFBWCxDQUFnQmIsSUFBaEI7QUFDQSxhQUFPQSxJQUFQO0FBQ0gsS0F2RDBEO0FBeUQzRGUsSUFBQUEsb0JBQW9CLEVBQUUsOEJBQVV4QixNQUFWLEVBQWtCO0FBQ3BDQSxNQUFBQSxNQUFNLENBQUNrQixNQUFQLEdBQWdCLElBQWhCO0FBQ0EsVUFBSU8sY0FBYyxHQUFHLElBQUk3QixxQkFBSixDQUEwQkksTUFBMUIsQ0FBckI7QUFDQSxXQUFLSyxLQUFMLENBQVdpQixJQUFYLENBQWdCRyxjQUFoQjtBQUNBLGFBQU9BLGNBQVA7QUFDSCxLQTlEMEQ7QUFnRTNEQyxJQUFBQSxZQUFZLEVBQUUsc0JBQVVqQixJQUFWLEVBQWdCO0FBQzFCLFVBQUlBLElBQUksS0FBSyxJQUFiLEVBQW1CO0FBQ2Y7QUFDSDs7QUFDRCxVQUFJa0IsU0FBUyxHQUFHbEIsSUFBSSxDQUFDUyxNQUFyQjtBQUNBekIsTUFBQUEsRUFBRSxDQUFDSSxJQUFILENBQVFvQixZQUFSLENBQXFCVSxTQUFTLENBQUN0QixLQUEvQixFQUFzQ0ksSUFBdEM7QUFDQUEsTUFBQUEsSUFBSSxDQUFDUyxNQUFMLEdBQWMsS0FBS0EsTUFBbkI7QUFDQSxVQUFJVSxLQUFLLEdBQUcsS0FBS1YsTUFBTCxDQUFZYixLQUFaLENBQWtCd0IsT0FBbEIsQ0FBMEIsSUFBMUIsQ0FBWjtBQUNBLFdBQUtYLE1BQUwsQ0FBWWIsS0FBWixDQUFrQnlCLE1BQWxCLENBQXlCRixLQUF6QixFQUFnQyxDQUFoQyxFQUFtQ25CLElBQW5DO0FBQ0gsS0F6RTBEO0FBMkUzRHNCLElBQUFBLGlCQUFpQixFQUFFLDJCQUFVdEIsSUFBVixFQUFnQjtBQUMvQixVQUFJdUIsaUJBQWlCLEdBQUd2QixJQUFJLENBQUNVLFNBQUwsRUFBeEI7QUFDQWEsTUFBQUEsaUJBQWlCLENBQUNkLE1BQWxCLEdBQTJCLEtBQUtBLE1BQWhDO0FBQ0EsVUFBSVUsS0FBSyxHQUFHLEtBQUtWLE1BQUwsQ0FBWWIsS0FBWixDQUFrQndCLE9BQWxCLENBQTBCLElBQTFCLENBQVo7QUFDQSxXQUFLWCxNQUFMLENBQVliLEtBQVosQ0FBa0J5QixNQUFsQixDQUF5QkYsS0FBekIsRUFBZ0MsQ0FBaEMsRUFBbUNJLGlCQUFuQztBQUNIO0FBaEYwRCxHQUFuQyxDQUE1QjtBQW9GQSxTQUFPcEMscUJBQVA7QUFFSCxDQXhGSyxDQUFOIiwic291cmNlc0NvbnRlbnQiOlsiZGVmaW5lKFsnLi4vLi4vLi4vc3JjL2luZGV4JywgJy4vT2JqZWN0JywgJy4vV29ya291dEl0ZW0nXSwgZnVuY3Rpb24gKHR0LCBPYmplY3QsIFdvcmtvdXRJdGVtKSB7XG5cbiAgICB2YXIgV29ya291dEl0ZW1Db2xsZWN0aW9uID0gdHQuY29yZS5kZWZpbmVEZXJpdmVkQ2xhc3MoT2JqZWN0LCB7XG5cbiAgICAgICAgaW5pdDogZnVuY3Rpb24gKHBhcmFtcykge1xuICAgICAgICAgICAgcGFyYW1zLm5hbWUgPSBwYXJhbXMubmFtZSB8fCAnJztcbiAgICAgICAgICAgIE9iamVjdC5wcm90b3R5cGUuaW5pdC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgICAgICAgdGhpcy5pdGVtcyA9IHBhcmFtcy5pdGVtcyB8fCBbXTtcbiAgICAgICAgICAgIHRoaXMucG9zdERlU2VyaWFsaXplKCk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgcG9zdERlU2VyaWFsaXplOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB0dC5jcmVhdGVSZWR1Y2VkTGlzdFByb3BlcnR5KHRoaXMsICdjaGVja2VkJywgdGhpcy5pdGVtcywgZnVuY3Rpb24gKGFjY3UsIGl0ZW0pIHtcbiAgICAgICAgICAgICAgICBpZiAoIWFjY3UgfHwgIWl0ZW0uZ2V0Q2hlY2tlZCgpKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LmJpbmQodGhpcyksIHRydWUpO1xuICAgICAgICAgICAgdHQuY3JlYXRlUmVkdWNlZExpc3RQcm9wZXJ0eSh0aGlzLCAndG90YWxEdXJhdGlvbicsIHRoaXMuaXRlbXMsIGZ1bmN0aW9uIChhY2N1LCBpdGVtKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGFjY3UgKyBpdGVtLmdldFRvdGFsRHVyYXRpb24oKTtcbiAgICAgICAgICAgIH0uYmluZCh0aGlzKSwgMCk7XG4gICAgICAgICAgICB0dC5jcmVhdGVSZWR1Y2VkTGlzdFByb3BlcnR5KHRoaXMsICdlbGFwc2VkJywgdGhpcy5pdGVtcywgZnVuY3Rpb24gKGFjY3UsIGl0ZW0pIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gYWNjdSArIGl0ZW0uZ2V0RWxhcHNlZCgpO1xuICAgICAgICAgICAgfS5iaW5kKHRoaXMpLCAwKTtcbiAgICAgICAgfSxcblxuICAgICAgICBkZWxldGU6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGlmICghT2JqZWN0LnByb3RvdHlwZS5kZWxldGUuYXBwbHkodGhpcywgYXJndW1lbnRzKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5pdGVtcy5sZW5ndGg7ICsraSkge1xuICAgICAgICAgICAgICAgIHZhciBpdGVtID0gdGhpcy5pdGVtc1tpXTtcbiAgICAgICAgICAgICAgICBpdGVtLmRlbGV0ZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdHQuY29yZS5yZW1vdmVPYmplY3QodGhpcy5wYXJlbnQuaXRlbXMsIHRoaXMpO1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH0sXG5cbiAgICAgICAgZGVlcENsb25lOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgY2xvbmVkSXRlbUNvbGxlY3Rpb24gPSBuZXcgV29ya291dEl0ZW1Db2xsZWN0aW9uKHtcbiAgICAgICAgICAgICAgICBuYW1lOiB0aGlzLm5hbWVcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLml0ZW1zLmxlbmd0aDsgKytpKSB7XG4gICAgICAgICAgICAgICAgdmFyIGl0ZW0gPSB0aGlzLml0ZW1zW2ldO1xuICAgICAgICAgICAgICAgIHZhciBjbG9uZWRJdGVtID0gaXRlbS5kZWVwQ2xvbmUoKTtcbiAgICAgICAgICAgICAgICBjbG9uZWRJdGVtLnBhcmVudCA9IGNsb25lZEl0ZW1Db2xsZWN0aW9uO1xuICAgICAgICAgICAgICAgIGNsb25lZEl0ZW1Db2xsZWN0aW9uLml0ZW1zLnB1c2goY2xvbmVkSXRlbSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gY2xvbmVkSXRlbUNvbGxlY3Rpb247XG4gICAgICAgIH0sXG5cbiAgICAgICAgY3JlYXRlSXRlbTogZnVuY3Rpb24gKHBhcmFtcykge1xuICAgICAgICAgICAgcGFyYW1zLnBhcmVudCA9IHRoaXM7XG4gICAgICAgICAgICB2YXIgaXRlbSA9IG5ldyBXb3Jrb3V0SXRlbShwYXJhbXMpO1xuICAgICAgICAgICAgdGhpcy5pdGVtcy5wdXNoKGl0ZW0pO1xuICAgICAgICAgICAgcmV0dXJuIGl0ZW07XG4gICAgICAgIH0sXG5cbiAgICAgICAgY3JlYXRlSXRlbUNvbGxlY3Rpb246IGZ1bmN0aW9uIChwYXJhbXMpIHtcbiAgICAgICAgICAgIHBhcmFtcy5wYXJlbnQgPSB0aGlzO1xuICAgICAgICAgICAgdmFyIGl0ZW1Db2xsZWN0aW9uID0gbmV3IFdvcmtvdXRJdGVtQ29sbGVjdGlvbihwYXJhbXMpO1xuICAgICAgICAgICAgdGhpcy5pdGVtcy5wdXNoKGl0ZW1Db2xsZWN0aW9uKTtcbiAgICAgICAgICAgIHJldHVybiBpdGVtQ29sbGVjdGlvbjtcbiAgICAgICAgfSxcblxuICAgICAgICBpbnNlcnRCZWZvcmU6IGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICAgICAgICBpZiAoaXRlbSA9PT0gdGhpcykge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBvbGRQYXJlbnQgPSBpdGVtLnBhcmVudDtcbiAgICAgICAgICAgIHR0LmNvcmUucmVtb3ZlT2JqZWN0KG9sZFBhcmVudC5pdGVtcywgaXRlbSk7XG4gICAgICAgICAgICBpdGVtLnBhcmVudCA9IHRoaXMucGFyZW50O1xuICAgICAgICAgICAgdmFyIGluZGV4ID0gdGhpcy5wYXJlbnQuaXRlbXMuaW5kZXhPZih0aGlzKTtcbiAgICAgICAgICAgIHRoaXMucGFyZW50Lml0ZW1zLnNwbGljZShpbmRleCwgMCwgaXRlbSk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgaW5zZXJ0Q2xvbmVCZWZvcmU6IGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICAgICAgICB2YXIgY2xvbmVkV29ya291dEl0ZW0gPSBpdGVtLmRlZXBDbG9uZSgpO1xuICAgICAgICAgICAgY2xvbmVkV29ya291dEl0ZW0ucGFyZW50ID0gdGhpcy5wYXJlbnQ7XG4gICAgICAgICAgICB2YXIgaW5kZXggPSB0aGlzLnBhcmVudC5pdGVtcy5pbmRleE9mKHRoaXMpO1xuICAgICAgICAgICAgdGhpcy5wYXJlbnQuaXRlbXMuc3BsaWNlKGluZGV4LCAwLCBjbG9uZWRXb3Jrb3V0SXRlbSk7XG4gICAgICAgIH1cblxuICAgIH0pO1xuXG4gICAgcmV0dXJuIFdvcmtvdXRJdGVtQ29sbGVjdGlvbjtcblxufSk7Il19