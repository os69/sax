"use strict";

define(['../../../../src/index', '../../model/Workout', '../../model/WorkoutItem', '../../model/WorkoutItemCollection', '../../model/ExerciseBasic', '../../../../controls/util', '../common/time', '../common/icons'], function (tt, Workout, WorkoutItem, WorkoutItemCollection, ExerciseBasic, controlsUtil, time, icons) {
  var module = {};

  module.createWorkoutItemDetailTtNode = function (params) {
    tt.initProperty(params.item, 'count');
    tt.initProperty(params.item, 'duration');
    return tt.createTtNode({
      type: 'div',
      children: [controlsUtil.createInputTtNode({
        label: 'count',
        value: function value() {
          return '' + params.item.getCount();
        },
        change: function change(event) {
          params.item.setCount(parseInt(event.srcElement.value));
        }
      }), controlsUtil.createInputTtNode({
        label: 'duration',
        value: function value() {
          return '' + time.int2ext(params.item.getDuration());
        },
        change: function change(event) {
          params.item.setDuration(time.ext2int(event.srcElement.value));
        }
      }), controlsUtil.createInputTtNode({
        label: 'total',
        value: function value() {
          return '' + time.int2ext(params.item.getTotalDuration());
        },
        disabled: true
      }), controlsUtil.createInputTtNode({
        label: 'name (description)',
        value: function value() {
          return params.item.getName();
        },
        change: function change(event) {
          params.item.setName(event.srcElement.value);
        }
      })]
    });
  };

  module.createWorkoutItemCollectionDetailTtNode = function (params) {
    return tt.createTtNode({
      type: 'div',
      children: [controlsUtil.createInputTtNode({
        label: 'name',
        value: function value() {
          return params.itemCollection.getName();
        },
        change: function change(event) {
          params.item.setName(event.srcElement.value);
        }
      }), controlsUtil.createInputTtNode({
        label: 'total',
        value: function value() {
          return '' + time.int2ext(params.itemCollection.getTotalDuration());
        },
        disabled: true
      })]
    });
  };

  module.createWorkoutBasicDetailTtNode = function (params) {
    return tt.createTtNode({
      type: 'div',
      children: [controlsUtil.createInputTtNode({
        label: 'name',
        value: function value() {
          return params.workout.getName();
        },
        change: function change(event) {
          params.workout.setName(event.srcElement.value);
        }
      }), controlsUtil.createInputTtNode({
        label: 'total',
        value: function value() {
          return '' + time.int2ext(params.workout.getTotalDuration());
        },
        disabled: true
      })]
    });
  };

  module.createWorkoutItemTreeNode = function (params) {
    tt.initProperty(params.item, 'name');
    tt.initProperty(params.item, 'count');
    tt.initProperty(params.item, 'duration');
    tt.initProperty(params.item, 'exercise');
    tt.initProperty(params.item.exercise, 'name');
    return {
      item: params.item,
      labelTtNodes: [controlsUtil.createIconTtNode({
        click: function click() {
          params.ui.setDetail(params.item);
        },
        icon: icons.WorkoutItem
      }), tt.createTtNode({
        type: 'span',
        css: ['item-exercise-name'],
        text: function text() {
          return params.item.getExercise().getName();
        }
      }), tt.createTtNode({
        type: 'div',
        css: ['item-count-input'],
        contenteditable: true,
        click: function click() {
          params.ui.setDetail(params.item);
        },
        text: function text() {
          return '' + params.item.getCount();
        },
        blur: function blur(event) {
          params.item.setCount(parseInt(event.srcElement.innerText));
        }
      }), tt.createTtNode({
        type: 'div',
        css: ['item-duration-input'],
        contenteditable: true,
        click: function click() {
          params.ui.setDetail(params.item);
        },
        text: function text() {
          return '' + time.int2ext(params.item.getDuration());
        },
        blur: function blur(event) {
          params.item.setDuration(time.ext2int(event.srcElement.innerText));
        }
      }), tt.createTtNode({
        type: 'div',
        css: ['item-name-input'],
        contenteditable: true,
        click: function click() {
          params.ui.setDetail(params.item);
        },
        text: function text() {
          return params.item.getName();
        },
        blur: function blur(event) {
          params.item.setName(event.srcElement.innerText);
        }
      }), controlsUtil.createIconTtNode({
        click: function () {
          params.item.delete();
        }.bind(this),
        icon: ['fas', 'fa-trash-alt']
      })],
      childNodes: [],
      drop: function drop(droppedTreeNode, event) {
        if (droppedTreeNode.item instanceof WorkoutItem || droppedTreeNode.item instanceof WorkoutItemCollection) {
          if (!event.shiftKey) {
            params.item.insertBefore(droppedTreeNode.item);
          } else {
            params.item.insertCloneBefore(droppedTreeNode.item);
          }

          return;
        }

        if (droppedTreeNode.exercise instanceof ExerciseBasic) {
          params.item.createItemBefore({
            exercise: droppedTreeNode.exercise
          });
          return;
        }
      }
    };
  };

  module.createWorkoutItemCollectionTreeNode = function (params) {
    tt.initProperty(params.itemCollection, 'name');
    return {
      item: params.itemCollection,
      labelTtNodes: [controlsUtil.createIconTtNode({
        click: function click() {
          params.ui.setDetail(params.itemCollection);
        },
        icon: icons.WorkoutItemCollection
      }), tt.createTtNode({
        type: 'input',
        css: ['name-input'],
        value: function value() {
          return params.itemCollection.getName();
        },
        change: function change(event) {
          params.itemCollection.setName(event.srcElement.value);
        },
        click: function click() {
          params.ui.setDetail(params.itemCollection);
        }
      }), controlsUtil.createIconTtNode({
        click: function () {
          params.itemCollection.createItemCollection({
            name: 'New Item Collection'
          });
        }.bind(this),
        icon: icons.createWorkoutItemCollection
      }), controlsUtil.createIconTtNode({
        click: function () {
          params.itemCollection.delete();
        }.bind(this),
        icon: ['fas', 'fa-trash-alt']
      })],
      childNodes: tt.createMappedList(params.itemCollection.items, function (item) {
        if (item instanceof WorkoutItem) {
          return module.createWorkoutItemTreeNode(tt.core.cloneExtend(params, {
            item: item
          }));
        }

        if (item instanceof WorkoutItemCollection) {
          return module.createWorkoutItemCollectionTreeNode(tt.core.cloneExtend(params, {
            itemCollection: item
          }));
        }
      }),
      drop: function drop(droppedTreeNode, event) {
        if (droppedTreeNode.item instanceof WorkoutItem || droppedTreeNode.item instanceof WorkoutItemCollection) {
          if (!event.shiftKey) {
            params.itemCollection.insertBefore(droppedTreeNode.item);
          } else {
            params.itemCollection.insertCloneBefore(droppedTreeNode.item);
          }

          return;
        }

        if (droppedTreeNode.exercise instanceof ExerciseBasic) {
          params.itemCollection.createItem({
            exercise: droppedTreeNode.exercise
          });
          return;
        }
      }
    };
  };

  module.createWorkoutBasicTreeNode = function (params) {
    tt.initProperty(params.workout, 'name');
    return {
      workout: params.workout,
      labelTtNodes: [controlsUtil.createIconTtNode({
        click: function click() {
          params.ui.setDetail(params.workout);
        },
        icon: icons.WorkoutBasic
      }), tt.createTtNode({
        type: 'input',
        css: ['name-input'],
        value: function value() {
          return params.workout.getName();
        },
        change: function change(event) {
          params.workout.setName(event.srcElement.value);
        },
        click: function click() {
          params.ui.setDetail(params.workout);
        }
      }), controlsUtil.createIconTtNode({
        click: function () {
          params.workout.createItemCollection({
            name: 'New Item Collection'
          });
        }.bind(this),
        icon: icons.createWorkoutItemCollection
      }), controlsUtil.createIconTtNode({
        click: function () {
          params.workout.delete();
        }.bind(this),
        icon: ['fas', 'fa-trash-alt']
      })],
      childNodes: tt.createMappedList(params.workout.items, function (item) {
        if (item instanceof WorkoutItem) {
          return module.createWorkoutItemTreeNode(tt.core.cloneExtend(params, {
            item: item
          }));
        }

        if (item instanceof WorkoutItemCollection) {
          return module.createWorkoutItemCollectionTreeNode(tt.core.cloneExtend(params, {
            itemCollection: item
          }));
        }
      }),
      drop: function drop(droppedTreeNode) {
        if (droppedTreeNode.exercise instanceof ExerciseBasic) {
          params.workout.createItem({
            exercise: droppedTreeNode.exercise
          });
          return;
        }

        if (droppedTreeNode.workout instanceof Workout) {
          params.workout.insertBefore(droppedTreeNode.workout);
          return;
        }
      }
    };
  };

  module.createWorkoutCollectionTreeNode = function (params) {
    tt.initProperty(params.workout, 'name');
    return {
      workout: params.workouts,
      labelTtNodes: [controlsUtil.createIconTtNode({
        icon: icons.WorkoutCollection
      }), tt.createTtNode({
        type: 'input',
        css: ['name-input'],
        value: function value() {
          return params.workout.getName();
        },
        change: function change(event) {
          params.workout.setName(event.srcElement.value);
        }
      }), controlsUtil.createIconTtNode({
        click: function () {
          params.workout.createWorkoutCollection({
            name: 'New Collection'
          });
        }.bind(this),
        icon: icons.createWorkoutCollection
      }), controlsUtil.createIconTtNode({
        click: function () {
          params.workout.createWorkoutBasic({
            name: 'New Workout'
          });
        }.bind(this),
        icon: icons.WorkoutBasic
      }), controlsUtil.createIconTtNode({
        click: function () {
          params.workout.delete();
        }.bind(this),
        icon: ['fas', 'fa-trash-alt']
      })],
      childNodes: tt.createMappedList(params.workout.workouts, function (workout) {
        return module.createWorkoutTreeNode(tt.core.cloneExtend(params, {
          workout: workout
        }));
      }),
      drop: function drop(droppedTreeNode) {
        if (droppedTreeNode.workout instanceof Workout) {
          params.workout.insertBefore(droppedTreeNode.workout);
          return;
        }
      }
    };
  };

  module.createWorkoutTreeNode = function (params) {
    if (params.workout.workouts) {
      return module.createWorkoutCollectionTreeNode(params);
    } else {
      return module.createWorkoutBasicTreeNode(params);
    }
  };

  return module;
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uL3NhbXBsZXMvc3BvcnRzL3VpL2Rlc2t0b3Avd29ya291dC5qcyJdLCJuYW1lcyI6WyJkZWZpbmUiLCJ0dCIsIldvcmtvdXQiLCJXb3Jrb3V0SXRlbSIsIldvcmtvdXRJdGVtQ29sbGVjdGlvbiIsIkV4ZXJjaXNlQmFzaWMiLCJjb250cm9sc1V0aWwiLCJ0aW1lIiwiaWNvbnMiLCJtb2R1bGUiLCJjcmVhdGVXb3Jrb3V0SXRlbURldGFpbFR0Tm9kZSIsInBhcmFtcyIsImluaXRQcm9wZXJ0eSIsIml0ZW0iLCJjcmVhdGVUdE5vZGUiLCJ0eXBlIiwiY2hpbGRyZW4iLCJjcmVhdGVJbnB1dFR0Tm9kZSIsImxhYmVsIiwidmFsdWUiLCJnZXRDb3VudCIsImNoYW5nZSIsImV2ZW50Iiwic2V0Q291bnQiLCJwYXJzZUludCIsInNyY0VsZW1lbnQiLCJpbnQyZXh0IiwiZ2V0RHVyYXRpb24iLCJzZXREdXJhdGlvbiIsImV4dDJpbnQiLCJnZXRUb3RhbER1cmF0aW9uIiwiZGlzYWJsZWQiLCJnZXROYW1lIiwic2V0TmFtZSIsImNyZWF0ZVdvcmtvdXRJdGVtQ29sbGVjdGlvbkRldGFpbFR0Tm9kZSIsIml0ZW1Db2xsZWN0aW9uIiwiY3JlYXRlV29ya291dEJhc2ljRGV0YWlsVHROb2RlIiwid29ya291dCIsImNyZWF0ZVdvcmtvdXRJdGVtVHJlZU5vZGUiLCJleGVyY2lzZSIsImxhYmVsVHROb2RlcyIsImNyZWF0ZUljb25UdE5vZGUiLCJjbGljayIsInVpIiwic2V0RGV0YWlsIiwiaWNvbiIsImNzcyIsInRleHQiLCJnZXRFeGVyY2lzZSIsImNvbnRlbnRlZGl0YWJsZSIsImJsdXIiLCJpbm5lclRleHQiLCJkZWxldGUiLCJiaW5kIiwiY2hpbGROb2RlcyIsImRyb3AiLCJkcm9wcGVkVHJlZU5vZGUiLCJzaGlmdEtleSIsImluc2VydEJlZm9yZSIsImluc2VydENsb25lQmVmb3JlIiwiY3JlYXRlSXRlbUJlZm9yZSIsImNyZWF0ZVdvcmtvdXRJdGVtQ29sbGVjdGlvblRyZWVOb2RlIiwiY3JlYXRlSXRlbUNvbGxlY3Rpb24iLCJuYW1lIiwiY3JlYXRlV29ya291dEl0ZW1Db2xsZWN0aW9uIiwiY3JlYXRlTWFwcGVkTGlzdCIsIml0ZW1zIiwiY29yZSIsImNsb25lRXh0ZW5kIiwiY3JlYXRlSXRlbSIsImNyZWF0ZVdvcmtvdXRCYXNpY1RyZWVOb2RlIiwiV29ya291dEJhc2ljIiwiY3JlYXRlV29ya291dENvbGxlY3Rpb25UcmVlTm9kZSIsIndvcmtvdXRzIiwiV29ya291dENvbGxlY3Rpb24iLCJjcmVhdGVXb3Jrb3V0Q29sbGVjdGlvbiIsImNyZWF0ZVdvcmtvdXRCYXNpYyIsImNyZWF0ZVdvcmtvdXRUcmVlTm9kZSJdLCJtYXBwaW5ncyI6Ijs7QUFBQUEsTUFBTSxDQUFDLENBQUMsdUJBQUQsRUFBMEIscUJBQTFCLEVBQWlELHlCQUFqRCxFQUE0RSxtQ0FBNUUsRUFBaUgsMkJBQWpILEVBQThJLDJCQUE5SSxFQUEySyxnQkFBM0ssRUFBNkwsaUJBQTdMLENBQUQsRUFBa04sVUFBVUMsRUFBVixFQUFjQyxPQUFkLEVBQXVCQyxXQUF2QixFQUFvQ0MscUJBQXBDLEVBQTJEQyxhQUEzRCxFQUEwRUMsWUFBMUUsRUFBd0ZDLElBQXhGLEVBQThGQyxLQUE5RixFQUFxRztBQUV6VCxNQUFJQyxNQUFNLEdBQUcsRUFBYjs7QUFFQUEsRUFBQUEsTUFBTSxDQUFDQyw2QkFBUCxHQUF1QyxVQUFVQyxNQUFWLEVBQWtCO0FBQ3JEVixJQUFBQSxFQUFFLENBQUNXLFlBQUgsQ0FBZ0JELE1BQU0sQ0FBQ0UsSUFBdkIsRUFBNkIsT0FBN0I7QUFDQVosSUFBQUEsRUFBRSxDQUFDVyxZQUFILENBQWdCRCxNQUFNLENBQUNFLElBQXZCLEVBQTZCLFVBQTdCO0FBQ0EsV0FBT1osRUFBRSxDQUFDYSxZQUFILENBQWdCO0FBQ25CQyxNQUFBQSxJQUFJLEVBQUUsS0FEYTtBQUVuQkMsTUFBQUEsUUFBUSxFQUFFLENBQ05WLFlBQVksQ0FBQ1csaUJBQWIsQ0FBK0I7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QixPQUFQLENBQWVvQyxRQUFuQixFQUE2QjtBQUN6QixhQUFPaEUsTUFBTSxDQUFDK0QsK0JBQVAsQ0FBdUM3RCxNQUF2QyxDQUFQO0FBQ0gsS0FGRCxNQUVPO0FBQ0gsYUFBT0YsTUFBTSxDQUFDNkQsMEJBQVAsQ0FBa0MzRCxNQUFsQyxDQUFQO0FBQ0g7QUFDSixHQU5EOztBQVFBLFNBQU9GLE1BQVA7QUFFSCxDQTlWSyxDQUFOIiwic291cmNlc0NvbnRlbnQiOlsiZGVmaW5lKFsnLi4vLi4vLi4vLi4vc3JjL2luZGV4JywgJy4uLy4uL21vZGVsL1dvcmtvdXQnLCAnLi4vLi4vbW9kZWwvV29ya291dEl0ZW0nLCAnLi4vLi4vbW9kZWwvV29ya291dEl0ZW1Db2xsZWN0aW9uJywgJy4uLy4uL21vZGVsL0V4ZXJjaXNlQmFzaWMnLCAnLi4vLi4vLi4vLi4vY29udHJvbHMvdXRpbCcsICcuLi9jb21tb24vdGltZScsICcuLi9jb21tb24vaWNvbnMnXSwgZnVuY3Rpb24gKHR0LCBXb3Jrb3V0LCBXb3Jrb3V0SXRlbSwgV29ya291dEl0ZW1Db2xsZWN0aW9uLCBFeGVyY2lzZUJhc2ljLCBjb250cm9sc1V0aWwsIHRpbWUsIGljb25zKSB7XG5cbiAgICB2YXIgbW9kdWxlID0ge307XG5cbiAgICBtb2R1bGUuY3JlYXRlV29ya291dEl0ZW1EZXRhaWxUdE5vZGUgPSBmdW5jdGlvbiAocGFyYW1zKSB7XG4gICAgICAgIHR0LmluaXRQcm9wZXJ0eShwYXJhbXMuaXRlbSwgJ2NvdW50Jyk7XG4gICAgICAgIHR0LmluaXRQcm9wZXJ0eShwYXJhbXMuaXRlbSwgJ2R1cmF0aW9uJyk7XG4gICAgICAgIHJldHVybiB0dC5jcmVhdGVUdE5vZGUoe1xuICAgICAgICAgICAgdHlwZTogJ2RpdicsXG4gICAgICAgICAgICBjaGlsZHJlbjogW1xuICAgICAgICAgICAgICAgIGNvbnRyb2xzVXRpbC5jcmVhdGVJbnB1dFR0Tm9kZSh7XG4gICAgICAgICAgICAgICAgICAgIGxhYmVsOiAnY291bnQnLFxuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICcnICsgcGFyYW1zLml0ZW0uZ2V0Q291bnQoKTtcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgY2hhbmdlOiBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhcmFtcy5pdGVtLnNldENvdW50KHBhcnNlSW50KGV2ZW50LnNyY0VsZW1lbnQudmFsdWUpKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgIGNvbnRyb2xzVXRpbC5jcmVhdGVJbnB1dFR0Tm9kZSh7XG4gICAgICAgICAgICAgICAgICAgIGxhYmVsOiAnZHVyYXRpb24nLFxuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICcnICsgdGltZS5pbnQyZXh0KHBhcmFtcy5pdGVtLmdldER1cmF0aW9uKCkpO1xuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBjaGFuZ2U6IGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcGFyYW1zLml0ZW0uc2V0RHVyYXRpb24odGltZS5leHQyaW50KGV2ZW50LnNyY0VsZW1lbnQudmFsdWUpKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgIGNvbnRyb2xzVXRpbC5jcmVhdGVJbnB1dFR0Tm9kZSh7XG4gICAgICAgICAgICAgICAgICAgIGxhYmVsOiAndG90YWwnLFxuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICcnICsgdGltZS5pbnQyZXh0KHBhcmFtcy5pdGVtLmdldFRvdGFsRHVyYXRpb24oKSk7XG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIGRpc2FibGVkOiB0cnVlXG4gICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgY29udHJvbHNVdGlsLmNyZWF0ZUlucHV0VHROb2RlKHtcbiAgICAgICAgICAgICAgICAgICAgbGFiZWw6ICduYW1lIChkZXNjcmlwdGlvbiknLFxuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHBhcmFtcy5pdGVtLmdldE5hbWUoKTtcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgY2hhbmdlOiBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhcmFtcy5pdGVtLnNldE5hbWUoZXZlbnQuc3JjRWxlbWVudC52YWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgXVxuICAgICAgICB9KTtcbiAgICB9O1xuXG4gICAgbW9kdWxlLmNyZWF0ZVdvcmtvdXRJdGVtQ29sbGVjdGlvbkRldGFpbFR0Tm9kZSA9IGZ1bmN0aW9uIChwYXJhbXMpIHtcbiAgICAgICAgcmV0dXJuIHR0LmNyZWF0ZVR0Tm9kZSh7XG4gICAgICAgICAgICB0eXBlOiAnZGl2JyxcbiAgICAgICAgICAgIGNoaWxkcmVuOiBbXG4gICAgICAgICAgICAgICAgY29udHJvbHNVdGlsLmNyZWF0ZUlucHV0VHROb2RlKHtcbiAgICAgICAgICAgICAgICAgICAgbGFiZWw6ICduYW1lJyxcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBwYXJhbXMuaXRlbUNvbGxlY3Rpb24uZ2V0TmFtZSgpO1xuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBjaGFuZ2U6IGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcGFyYW1zLml0ZW0uc2V0TmFtZShldmVudC5zcmNFbGVtZW50LnZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgIGNvbnRyb2xzVXRpbC5jcmVhdGVJbnB1dFR0Tm9kZSh7XG4gICAgICAgICAgICAgICAgICAgIGxhYmVsOiAndG90YWwnLFxuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICcnICsgdGltZS5pbnQyZXh0KHBhcmFtcy5pdGVtQ29sbGVjdGlvbi5nZXRUb3RhbER1cmF0aW9uKCkpO1xuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBkaXNhYmxlZDogdHJ1ZVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICBdXG4gICAgICAgIH0pO1xuICAgIH07XG5cbiAgICBtb2R1bGUuY3JlYXRlV29ya291dEJhc2ljRGV0YWlsVHROb2RlID0gZnVuY3Rpb24gKHBhcmFtcykge1xuICAgICAgICByZXR1cm4gdHQuY3JlYXRlVHROb2RlKHtcbiAgICAgICAgICAgIHR5cGU6ICdkaXYnLFxuICAgICAgICAgICAgY2hpbGRyZW46IFtcbiAgICAgICAgICAgICAgICBjb250cm9sc1V0aWwuY3JlYXRlSW5wdXRUdE5vZGUoe1xuICAgICAgICAgICAgICAgICAgICBsYWJlbDogJ25hbWUnLFxuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHBhcmFtcy53b3Jrb3V0LmdldE5hbWUoKTtcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgY2hhbmdlOiBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhcmFtcy53b3Jrb3V0LnNldE5hbWUoZXZlbnQuc3JjRWxlbWVudC52YWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICBjb250cm9sc1V0aWwuY3JlYXRlSW5wdXRUdE5vZGUoe1xuICAgICAgICAgICAgICAgICAgICBsYWJlbDogJ3RvdGFsJyxcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAnJyArIHRpbWUuaW50MmV4dChwYXJhbXMud29ya291dC5nZXRUb3RhbER1cmF0aW9uKCkpO1xuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBkaXNhYmxlZDogdHJ1ZVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICBdXG4gICAgICAgIH0pO1xuICAgIH07XG5cbiAgICBtb2R1bGUuY3JlYXRlV29ya291dEl0ZW1UcmVlTm9kZSA9IGZ1bmN0aW9uIChwYXJhbXMpIHtcbiAgICAgICAgdHQuaW5pdFByb3BlcnR5KHBhcmFtcy5pdGVtLCAnbmFtZScpO1xuICAgICAgICB0dC5pbml0UHJvcGVydHkocGFyYW1zLml0ZW0sICdjb3VudCcpO1xuICAgICAgICB0dC5pbml0UHJvcGVydHkocGFyYW1zLml0ZW0sICdkdXJhdGlvbicpO1xuICAgICAgICB0dC5pbml0UHJvcGVydHkocGFyYW1zLml0ZW0sICdleGVyY2lzZScpO1xuICAgICAgICB0dC5pbml0UHJvcGVydHkocGFyYW1zLml0ZW0uZXhlcmNpc2UsICduYW1lJyk7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBpdGVtOiBwYXJhbXMuaXRlbSxcbiAgICAgICAgICAgIGxhYmVsVHROb2RlczogW1xuICAgICAgICAgICAgICAgIGNvbnRyb2xzVXRpbC5jcmVhdGVJY29uVHROb2RlKHtcbiAgICAgICAgICAgICAgICAgICAgY2xpY2s6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhcmFtcy51aS5zZXREZXRhaWwocGFyYW1zLml0ZW0pO1xuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBpY29uOiBpY29ucy5Xb3Jrb3V0SXRlbVxuICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgIHR0LmNyZWF0ZVR0Tm9kZSh7XG4gICAgICAgICAgICAgICAgICAgIHR5cGU6ICdzcGFuJyxcbiAgICAgICAgICAgICAgICAgICAgY3NzOiBbJ2l0ZW0tZXhlcmNpc2UtbmFtZSddLFxuICAgICAgICAgICAgICAgICAgICB0ZXh0OiBmdW5jdGlvbiAoKSB7IHJldHVybiBwYXJhbXMuaXRlbS5nZXRFeGVyY2lzZSgpLmdldE5hbWUoKTsgfVxuICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgIHR0LmNyZWF0ZVR0Tm9kZSh7XG4gICAgICAgICAgICAgICAgICAgIHR5cGU6ICdkaXYnLFxuICAgICAgICAgICAgICAgICAgICBjc3M6IFsnaXRlbS1jb3VudC1pbnB1dCddLFxuICAgICAgICAgICAgICAgICAgICBjb250ZW50ZWRpdGFibGU6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIGNsaWNrOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwYXJhbXMudWkuc2V0RGV0YWlsKHBhcmFtcy5pdGVtKTtcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgdGV4dDogZnVuY3Rpb24gKCkgeyByZXR1cm4gJycgKyBwYXJhbXMuaXRlbS5nZXRDb3VudCgpOyB9LFxuICAgICAgICAgICAgICAgICAgICBibHVyOiBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhcmFtcy5pdGVtLnNldENvdW50KHBhcnNlSW50KGV2ZW50LnNyY0VsZW1lbnQuaW5uZXJUZXh0KSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICB0dC5jcmVhdGVUdE5vZGUoe1xuICAgICAgICAgICAgICAgICAgICB0eXBlOiAnZGl2JyxcbiAgICAgICAgICAgICAgICAgICAgY3NzOiBbJ2l0ZW0tZHVyYXRpb24taW5wdXQnXSxcbiAgICAgICAgICAgICAgICAgICAgY29udGVudGVkaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICBjbGljazogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcGFyYW1zLnVpLnNldERldGFpbChwYXJhbXMuaXRlbSk7XG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHRleHQ6IGZ1bmN0aW9uICgpIHsgcmV0dXJuICcnICsgdGltZS5pbnQyZXh0KHBhcmFtcy5pdGVtLmdldER1cmF0aW9uKCkpOyB9LFxuICAgICAgICAgICAgICAgICAgICBibHVyOiBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhcmFtcy5pdGVtLnNldER1cmF0aW9uKHRpbWUuZXh0MmludChldmVudC5zcmNFbGVtZW50LmlubmVyVGV4dCkpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgdHQuY3JlYXRlVHROb2RlKHtcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogJ2RpdicsXG4gICAgICAgICAgICAgICAgICAgIGNzczogWydpdGVtLW5hbWUtaW5wdXQnXSxcbiAgICAgICAgICAgICAgICAgICAgY29udGVudGVkaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICBjbGljazogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcGFyYW1zLnVpLnNldERldGFpbChwYXJhbXMuaXRlbSk7XG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHRleHQ6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHBhcmFtcy5pdGVtLmdldE5hbWUoKTsgfSxcbiAgICAgICAgICAgICAgICAgICAgYmx1cjogZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwYXJhbXMuaXRlbS5zZXROYW1lKGV2ZW50LnNyY0VsZW1lbnQuaW5uZXJUZXh0KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgIGNvbnRyb2xzVXRpbC5jcmVhdGVJY29uVHROb2RlKHtcbiAgICAgICAgICAgICAgICAgICAgY2xpY2s6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhcmFtcy5pdGVtLmRlbGV0ZSgpO1xuICAgICAgICAgICAgICAgICAgICB9LmJpbmQodGhpcyksXG4gICAgICAgICAgICAgICAgICAgIGljb246IFsnZmFzJywgJ2ZhLXRyYXNoLWFsdCddXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIF0sXG4gICAgICAgICAgICBjaGlsZE5vZGVzOiBbXSxcbiAgICAgICAgICAgIGRyb3A6IGZ1bmN0aW9uIChkcm9wcGVkVHJlZU5vZGUsIGV2ZW50KSB7XG4gICAgICAgICAgICAgICAgaWYgKGRyb3BwZWRUcmVlTm9kZS5pdGVtIGluc3RhbmNlb2YgV29ya291dEl0ZW0gfHwgZHJvcHBlZFRyZWVOb2RlLml0ZW0gaW5zdGFuY2VvZiBXb3Jrb3V0SXRlbUNvbGxlY3Rpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFldmVudC5zaGlmdEtleSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcGFyYW1zLml0ZW0uaW5zZXJ0QmVmb3JlKGRyb3BwZWRUcmVlTm9kZS5pdGVtKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhcmFtcy5pdGVtLmluc2VydENsb25lQmVmb3JlKGRyb3BwZWRUcmVlTm9kZS5pdGVtKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChkcm9wcGVkVHJlZU5vZGUuZXhlcmNpc2UgaW5zdGFuY2VvZiBFeGVyY2lzZUJhc2ljKSB7XG4gICAgICAgICAgICAgICAgICAgIHBhcmFtcy5pdGVtLmNyZWF0ZUl0ZW1CZWZvcmUoeyBleGVyY2lzZTogZHJvcHBlZFRyZWVOb2RlLmV4ZXJjaXNlIH0pO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgIH07XG5cbiAgICBtb2R1bGUuY3JlYXRlV29ya291dEl0ZW1Db2xsZWN0aW9uVHJlZU5vZGUgPSBmdW5jdGlvbiAocGFyYW1zKSB7XG4gICAgICAgIHR0LmluaXRQcm9wZXJ0eShwYXJhbXMuaXRlbUNvbGxlY3Rpb24sICduYW1lJyk7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBpdGVtOiBwYXJhbXMuaXRlbUNvbGxlY3Rpb24sXG4gICAgICAgICAgICBsYWJlbFR0Tm9kZXM6IFtcbiAgICAgICAgICAgICAgICBjb250cm9sc1V0aWwuY3JlYXRlSWNvblR0Tm9kZSh7XG4gICAgICAgICAgICAgICAgICAgIGNsaWNrOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwYXJhbXMudWkuc2V0RGV0YWlsKHBhcmFtcy5pdGVtQ29sbGVjdGlvbik7XG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIGljb246IGljb25zLldvcmtvdXRJdGVtQ29sbGVjdGlvblxuICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgIHR0LmNyZWF0ZVR0Tm9kZSh7XG4gICAgICAgICAgICAgICAgICAgIHR5cGU6ICdpbnB1dCcsXG4gICAgICAgICAgICAgICAgICAgIGNzczogWyduYW1lLWlucHV0J10sXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiAoKSB7IHJldHVybiBwYXJhbXMuaXRlbUNvbGxlY3Rpb24uZ2V0TmFtZSgpOyB9LFxuICAgICAgICAgICAgICAgICAgICBjaGFuZ2U6IGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcGFyYW1zLml0ZW1Db2xsZWN0aW9uLnNldE5hbWUoZXZlbnQuc3JjRWxlbWVudC52YWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIGNsaWNrOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwYXJhbXMudWkuc2V0RGV0YWlsKHBhcmFtcy5pdGVtQ29sbGVjdGlvbik7XG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgY29udHJvbHNVdGlsLmNyZWF0ZUljb25UdE5vZGUoe1xuICAgICAgICAgICAgICAgICAgICBjbGljazogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcGFyYW1zLml0ZW1Db2xsZWN0aW9uLmNyZWF0ZUl0ZW1Db2xsZWN0aW9uKHsgbmFtZTogJ05ldyBJdGVtIENvbGxlY3Rpb24nIH0pO1xuICAgICAgICAgICAgICAgICAgICB9LmJpbmQodGhpcyksXG4gICAgICAgICAgICAgICAgICAgIGljb246IGljb25zLmNyZWF0ZVdvcmtvdXRJdGVtQ29sbGVjdGlvblxuICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgIGNvbnRyb2xzVXRpbC5jcmVhdGVJY29uVHROb2RlKHtcbiAgICAgICAgICAgICAgICAgICAgY2xpY2s6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhcmFtcy5pdGVtQ29sbGVjdGlvbi5kZWxldGUoKTtcbiAgICAgICAgICAgICAgICAgICAgfS5iaW5kKHRoaXMpLFxuICAgICAgICAgICAgICAgICAgICBpY29uOiBbJ2ZhcycsICdmYS10cmFzaC1hbHQnXVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICBdLFxuICAgICAgICAgICAgY2hpbGROb2RlczogdHQuY3JlYXRlTWFwcGVkTGlzdChwYXJhbXMuaXRlbUNvbGxlY3Rpb24uaXRlbXMsIGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICAgICAgICAgICAgaWYgKGl0ZW0gaW5zdGFuY2VvZiBXb3Jrb3V0SXRlbSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbW9kdWxlLmNyZWF0ZVdvcmtvdXRJdGVtVHJlZU5vZGUodHQuY29yZS5jbG9uZUV4dGVuZChwYXJhbXMsIHsgaXRlbTogaXRlbSB9KSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChpdGVtIGluc3RhbmNlb2YgV29ya291dEl0ZW1Db2xsZWN0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBtb2R1bGUuY3JlYXRlV29ya291dEl0ZW1Db2xsZWN0aW9uVHJlZU5vZGUodHQuY29yZS5jbG9uZUV4dGVuZChwYXJhbXMsIHsgaXRlbUNvbGxlY3Rpb246IGl0ZW0gfSkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgZHJvcDogZnVuY3Rpb24gKGRyb3BwZWRUcmVlTm9kZSwgZXZlbnQpIHtcbiAgICAgICAgICAgICAgICBpZiAoZHJvcHBlZFRyZWVOb2RlLml0ZW0gaW5zdGFuY2VvZiBXb3Jrb3V0SXRlbSB8fCBkcm9wcGVkVHJlZU5vZGUuaXRlbSBpbnN0YW5jZW9mIFdvcmtvdXRJdGVtQ29sbGVjdGlvbikge1xuICAgICAgICAgICAgICAgICAgICBpZiAoIWV2ZW50LnNoaWZ0S2V5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwYXJhbXMuaXRlbUNvbGxlY3Rpb24uaW5zZXJ0QmVmb3JlKGRyb3BwZWRUcmVlTm9kZS5pdGVtKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhcmFtcy5pdGVtQ29sbGVjdGlvbi5pbnNlcnRDbG9uZUJlZm9yZShkcm9wcGVkVHJlZU5vZGUuaXRlbSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoZHJvcHBlZFRyZWVOb2RlLmV4ZXJjaXNlIGluc3RhbmNlb2YgRXhlcmNpc2VCYXNpYykge1xuICAgICAgICAgICAgICAgICAgICBwYXJhbXMuaXRlbUNvbGxlY3Rpb24uY3JlYXRlSXRlbSh7IGV4ZXJjaXNlOiBkcm9wcGVkVHJlZU5vZGUuZXhlcmNpc2UgfSk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgfTtcblxuICAgIG1vZHVsZS5jcmVhdGVXb3Jrb3V0QmFzaWNUcmVlTm9kZSA9IGZ1bmN0aW9uIChwYXJhbXMpIHtcbiAgICAgICAgdHQuaW5pdFByb3BlcnR5KHBhcmFtcy53b3Jrb3V0LCAnbmFtZScpO1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgd29ya291dDogcGFyYW1zLndvcmtvdXQsXG4gICAgICAgICAgICBsYWJlbFR0Tm9kZXM6IFtcbiAgICAgICAgICAgICAgICBjb250cm9sc1V0aWwuY3JlYXRlSWNvblR0Tm9kZSh7XG4gICAgICAgICAgICAgICAgICAgIGNsaWNrOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwYXJhbXMudWkuc2V0RGV0YWlsKHBhcmFtcy53b3Jrb3V0KTtcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgaWNvbjogaWNvbnMuV29ya291dEJhc2ljXG4gICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgdHQuY3JlYXRlVHROb2RlKHtcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogJ2lucHV0JyxcbiAgICAgICAgICAgICAgICAgICAgY3NzOiBbJ25hbWUtaW5wdXQnXSxcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHBhcmFtcy53b3Jrb3V0LmdldE5hbWUoKTsgfSxcbiAgICAgICAgICAgICAgICAgICAgY2hhbmdlOiBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhcmFtcy53b3Jrb3V0LnNldE5hbWUoZXZlbnQuc3JjRWxlbWVudC52YWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIGNsaWNrOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwYXJhbXMudWkuc2V0RGV0YWlsKHBhcmFtcy53b3Jrb3V0KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgIGNvbnRyb2xzVXRpbC5jcmVhdGVJY29uVHROb2RlKHtcbiAgICAgICAgICAgICAgICAgICAgY2xpY2s6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhcmFtcy53b3Jrb3V0LmNyZWF0ZUl0ZW1Db2xsZWN0aW9uKHsgbmFtZTogJ05ldyBJdGVtIENvbGxlY3Rpb24nIH0pO1xuICAgICAgICAgICAgICAgICAgICB9LmJpbmQodGhpcyksXG4gICAgICAgICAgICAgICAgICAgIGljb246IGljb25zLmNyZWF0ZVdvcmtvdXRJdGVtQ29sbGVjdGlvblxuICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgIGNvbnRyb2xzVXRpbC5jcmVhdGVJY29uVHROb2RlKHtcbiAgICAgICAgICAgICAgICAgICAgY2xpY2s6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhcmFtcy53b3Jrb3V0LmRlbGV0ZSgpO1xuICAgICAgICAgICAgICAgICAgICB9LmJpbmQodGhpcyksXG4gICAgICAgICAgICAgICAgICAgIGljb246IFsnZmFzJywgJ2ZhLXRyYXNoLWFsdCddXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIF0sXG4gICAgICAgICAgICBjaGlsZE5vZGVzOiB0dC5jcmVhdGVNYXBwZWRMaXN0KHBhcmFtcy53b3Jrb3V0Lml0ZW1zLCBmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgICAgICAgICAgIGlmIChpdGVtIGluc3RhbmNlb2YgV29ya291dEl0ZW0pIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG1vZHVsZS5jcmVhdGVXb3Jrb3V0SXRlbVRyZWVOb2RlKHR0LmNvcmUuY2xvbmVFeHRlbmQocGFyYW1zLCB7IGl0ZW06IGl0ZW0gfSkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoaXRlbSBpbnN0YW5jZW9mIFdvcmtvdXRJdGVtQ29sbGVjdGlvbikge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbW9kdWxlLmNyZWF0ZVdvcmtvdXRJdGVtQ29sbGVjdGlvblRyZWVOb2RlKHR0LmNvcmUuY2xvbmVFeHRlbmQocGFyYW1zLCB7IGl0ZW1Db2xsZWN0aW9uOiBpdGVtIH0pKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICAgIGRyb3A6IGZ1bmN0aW9uIChkcm9wcGVkVHJlZU5vZGUpIHtcbiAgICAgICAgICAgICAgICBpZiAoZHJvcHBlZFRyZWVOb2RlLmV4ZXJjaXNlIGluc3RhbmNlb2YgRXhlcmNpc2VCYXNpYykge1xuICAgICAgICAgICAgICAgICAgICBwYXJhbXMud29ya291dC5jcmVhdGVJdGVtKHsgZXhlcmNpc2U6IGRyb3BwZWRUcmVlTm9kZS5leGVyY2lzZSB9KTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoZHJvcHBlZFRyZWVOb2RlLndvcmtvdXQgaW5zdGFuY2VvZiBXb3Jrb3V0KSB7XG4gICAgICAgICAgICAgICAgICAgIHBhcmFtcy53b3Jrb3V0Lmluc2VydEJlZm9yZShkcm9wcGVkVHJlZU5vZGUud29ya291dCk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgfTtcblxuICAgIG1vZHVsZS5jcmVhdGVXb3Jrb3V0Q29sbGVjdGlvblRyZWVOb2RlID0gZnVuY3Rpb24gKHBhcmFtcykge1xuICAgICAgICB0dC5pbml0UHJvcGVydHkocGFyYW1zLndvcmtvdXQsICduYW1lJyk7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICB3b3Jrb3V0OiBwYXJhbXMud29ya291dHMsXG4gICAgICAgICAgICBsYWJlbFR0Tm9kZXM6IFtcbiAgICAgICAgICAgICAgICBjb250cm9sc1V0aWwuY3JlYXRlSWNvblR0Tm9kZSh7XG4gICAgICAgICAgICAgICAgICAgIGljb246IGljb25zLldvcmtvdXRDb2xsZWN0aW9uXG4gICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgdHQuY3JlYXRlVHROb2RlKHtcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogJ2lucHV0JyxcbiAgICAgICAgICAgICAgICAgICAgY3NzOiBbJ25hbWUtaW5wdXQnXSxcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHBhcmFtcy53b3Jrb3V0LmdldE5hbWUoKTsgfSxcbiAgICAgICAgICAgICAgICAgICAgY2hhbmdlOiBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhcmFtcy53b3Jrb3V0LnNldE5hbWUoZXZlbnQuc3JjRWxlbWVudC52YWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICBjb250cm9sc1V0aWwuY3JlYXRlSWNvblR0Tm9kZSh7XG4gICAgICAgICAgICAgICAgICAgIGNsaWNrOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwYXJhbXMud29ya291dC5jcmVhdGVXb3Jrb3V0Q29sbGVjdGlvbih7IG5hbWU6ICdOZXcgQ29sbGVjdGlvbicgfSlcbiAgICAgICAgICAgICAgICAgICAgfS5iaW5kKHRoaXMpLFxuICAgICAgICAgICAgICAgICAgICBpY29uOiBpY29ucy5jcmVhdGVXb3Jrb3V0Q29sbGVjdGlvblxuICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgIGNvbnRyb2xzVXRpbC5jcmVhdGVJY29uVHROb2RlKHtcbiAgICAgICAgICAgICAgICAgICAgY2xpY2s6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhcmFtcy53b3Jrb3V0LmNyZWF0ZVdvcmtvdXRCYXNpYyh7IG5hbWU6ICdOZXcgV29ya291dCcgfSlcbiAgICAgICAgICAgICAgICAgICAgfS5iaW5kKHRoaXMpLFxuICAgICAgICAgICAgICAgICAgICBpY29uOiBpY29ucy5Xb3Jrb3V0QmFzaWNcbiAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICBjb250cm9sc1V0aWwuY3JlYXRlSWNvblR0Tm9kZSh7XG4gICAgICAgICAgICAgICAgICAgIGNsaWNrOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwYXJhbXMud29ya291dC5kZWxldGUoKTtcbiAgICAgICAgICAgICAgICAgICAgfS5iaW5kKHRoaXMpLFxuICAgICAgICAgICAgICAgICAgICBpY29uOiBbJ2ZhcycsICdmYS10cmFzaC1hbHQnXVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICBdLFxuICAgICAgICAgICAgY2hpbGROb2RlczogdHQuY3JlYXRlTWFwcGVkTGlzdChwYXJhbXMud29ya291dC53b3Jrb3V0cywgZnVuY3Rpb24gKHdvcmtvdXQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbW9kdWxlLmNyZWF0ZVdvcmtvdXRUcmVlTm9kZSh0dC5jb3JlLmNsb25lRXh0ZW5kKHBhcmFtcywgeyB3b3Jrb3V0OiB3b3Jrb3V0LCB9KSk7XG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICAgIGRyb3A6IGZ1bmN0aW9uIChkcm9wcGVkVHJlZU5vZGUpIHtcbiAgICAgICAgICAgICAgICBpZiAoZHJvcHBlZFRyZWVOb2RlLndvcmtvdXQgaW5zdGFuY2VvZiBXb3Jrb3V0KSB7XG4gICAgICAgICAgICAgICAgICAgIHBhcmFtcy53b3Jrb3V0Lmluc2VydEJlZm9yZShkcm9wcGVkVHJlZU5vZGUud29ya291dCk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgfTtcblxuICAgIG1vZHVsZS5jcmVhdGVXb3Jrb3V0VHJlZU5vZGUgPSBmdW5jdGlvbiAocGFyYW1zKSB7XG4gICAgICAgIGlmIChwYXJhbXMud29ya291dC53b3Jrb3V0cykge1xuICAgICAgICAgICAgcmV0dXJuIG1vZHVsZS5jcmVhdGVXb3Jrb3V0Q29sbGVjdGlvblRyZWVOb2RlKHBhcmFtcyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gbW9kdWxlLmNyZWF0ZVdvcmtvdXRCYXNpY1RyZWVOb2RlKHBhcmFtcyk7XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgcmV0dXJuIG1vZHVsZTtcblxufSk7XG4iXX0=