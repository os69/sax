"use strict";

require("core-js/modules/es.regexp.to-string");

define([], function () {
  var maxId = 0;
  var module = {
    // =========================================================================   
    // define class
    // =========================================================================
    object: function object(prototype) {
      return Object.create(prototype);
    },
    _generateConstructorFunction: function _generateConstructorFunction() {
      var _ConstructorFunction = null;

      _ConstructorFunction = function ConstructorFunction() {
        if (!(this instanceof _ConstructorFunction)) {
          return new _ConstructorFunction("blub", arguments);
        }

        if (this.init) {
          if (arguments.length == 2 && arguments[0] === "blub") {
            this.init.apply(this, arguments[1]);
          } else {
            this.init.apply(this, arguments);
          }
        }
      };

      _ConstructorFunction.derive = function (prototype) {
        return module.defineDerivedClass(this, prototype);
      };

      return _ConstructorFunction;
    },
    defineClass: function defineClass(prototype) {
      var Cls = module._generateConstructorFunction();

      Cls.prototype = prototype;
      Cls.prototype.constructor = Cls;
      return Cls;
    },
    defineDerivedClass: function defineDerivedClass(parentClass, prototype) {
      var Cls = module._generateConstructorFunction();

      Cls.prototype = module.extend(module.object(parentClass.prototype), prototype);
      Cls.prototype.constructor = Cls;
      return Cls;
    },
    // ===================================================================
    // type helpers
    // ===================================================================
    getType: function getType(obj) {
      if (typeof obj === 'function') return 'function';
      if (typeof obj === 'string') return 'simple';
      if (typeof obj === 'number') return 'simple';
      if (typeof obj === 'boolean') return 'simple';

      if (typeof obj === 'object') {
        if (Object.prototype.toString.call(obj) === '[object Array]') return 'list';
        return 'object';
      }

      throw "Not supported type:" + typeof obj;
    },
    isList: function isList(obj) {
      return this.getType(obj) === 'list';
    },
    isObject: function isObject(obj) {
      return this.getType(obj) === 'object';
    },
    isFunction: function isFunction(obj) {
      return this.getType(obj) === 'function';
    },
    isString: function isString(obj) {
      return typeof obj === 'string';
    },
    // ===================================================================
    // list helpers
    // ===================================================================
    hasObject: function hasObject(list, obj) {
      for (var i = 0; i < list.length; ++i) {
        var testObj = list[i];

        if (testObj === obj) {
          return true;
        }
      }

      return false;
    },
    removeObject: function removeObject(list, obj) {
      var numDel = 0;

      for (var i = 0; i < list.length; ++i) {
        var testObj = list[i];

        if (testObj === obj) {
          numDel++;
          list.splice(i, 1);
          i--;
          continue;
        }
      }

      return numDel;
    },
    splice: function splice(list, index, numDel, inserts) {
      var args = [];
      args.push(index, numDel);

      if (inserts) {
        args.push.apply(args, inserts);
      }

      list.splice.apply(list, args);
    },
    removeAll: function removeAll(list) {
      module.splice(list, 0, list.length);
    },
    // ===================================================================
    // object helpers
    // ===================================================================
    extend: function extend(obj1, obj2) {
      for (var propertyName in obj2) {
        obj1[propertyName] = obj2[propertyName];
      }

      return obj1;
    },
    cloneExtend: function cloneExtend(obj1, obj2) {
      var clone = this.extend({}, obj1);
      return this.extend(clone, obj2);
    },
    isEmpty: function isEmpty(obj) {
      for (var prop in obj) {
        return false;
      }

      return true;
    },
    get: function get(obj, key, defaultGenerator) {
      var value = obj[key];

      if (value) {
        return value;
      }

      value = defaultGenerator();
      obj[key] = value;
      return value;
    },
    defaultList: function defaultList() {
      return [];
    },
    defaultObject: function defaultObject() {
      return {};
    },
    // ===================================================================
    // id generation
    // ===================================================================
    generateId: function generateId() {
      return '#' + ++maxId;
    },
    argumentsToList: function argumentsToList(args) {
      return Array.prototype.slice.call(args);
    },
    // ===================================================================
    // others
    // ===================================================================
    remToPixels: function remToPixels(rem) {
      return rem * parseFloat(getComputedStyle(document.documentElement).fontSize);
    }
  };
  return module;
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9jb3JlL2NvcmUuanMiXSwibmFtZXMiOlsiZGVmaW5lIiwibWF4SWQiLCJtb2R1bGUiLCJvYmplY3QiLCJwcm90b3R5cGUiLCJPYmplY3QiLCJjcmVhdGUiLCJfZ2VuZXJhdGVDb25zdHJ1Y3RvckZ1bmN0aW9uIiwiQ29uc3RydWN0b3JGdW5jdGlvbiIsImFyZ3VtZW50cyIsImluaXQiLCJsZW5ndGgiLCJhcHBseSIsImRlcml2ZSIsImRlZmluZURlcml2ZWRDbGFzcyIsImRlZmluZUNsYXNzIiwiQ2xzIiwiY29uc3RydWN0b3IiLCJwYXJlbnRDbGFzcyIsImV4dGVuZCIsImdldFR5cGUiLCJvYmoiLCJ0b1N0cmluZyIsImNhbGwiLCJpc0xpc3QiLCJpc09iamVjdCIsImlzRnVuY3Rpb24iLCJpc1N0cmluZyIsImhhc09iamVjdCIsImxpc3QiLCJpIiwidGVzdE9iaiIsInJlbW92ZU9iamVjdCIsIm51bURlbCIsInNwbGljZSIsImluZGV4IiwiaW5zZXJ0cyIsImFyZ3MiLCJwdXNoIiwicmVtb3ZlQWxsIiwib2JqMSIsIm9iajIiLCJwcm9wZXJ0eU5hbWUiLCJjbG9uZUV4dGVuZCIsImNsb25lIiwiaXNFbXB0eSIsInByb3AiLCJnZXQiLCJrZXkiLCJkZWZhdWx0R2VuZXJhdG9yIiwidmFsdWUiLCJkZWZhdWx0TGlzdCIsImRlZmF1bHRPYmplY3QiLCJnZW5lcmF0ZUlkIiwiYXJndW1lbnRzVG9MaXN0IiwiQXJyYXkiLCJzbGljZSIsInJlbVRvUGl4ZWxzIiwicmVtIiwicGFyc2VGbG9hdCIsImdldENvbXB1dGVkU3R5bGUiLCJkb2N1bWVudCIsImRvY3VtZW50RWxlbWVudCIsImZvbnRTaXplIl0sIm1hcHBpbmdzIjoiOzs7O0FBQ0FBLE1BQU0sQ0FBQyxFQUFELEVBQUssWUFBWTtBQUVuQixNQUFJQyxLQUFLLEdBQUcsQ0FBWjtBQUVBLE1BQUlDLE1BQU0sR0FBRztBQUVUO0FBQ0E7QUFDQTtBQUVBQyxJQUFBQSxNQUFNLEVBQUUs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LCBmdW5jdGlvbiAoKSB7XG5cbiAgICB2YXIgbWF4SWQgPSAwO1xuXG4gICAgdmFyIG1vZHVsZSA9IHtcblxuICAgICAgICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09ICAgXG4gICAgICAgIC8vIGRlZmluZSBjbGFzc1xuICAgICAgICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbiAgICAgICAgb2JqZWN0OiBmdW5jdGlvbiAocHJvdG90eXBlKSB7XG4gICAgICAgICAgICByZXR1cm4gT2JqZWN0LmNyZWF0ZShwcm90b3R5cGUpO1xuICAgICAgICB9LFxuXG4gICAgICAgIF9nZW5lcmF0ZUNvbnN0cnVjdG9yRnVuY3Rpb246IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBDb25zdHJ1Y3RvckZ1bmN0aW9uID0gbnVsbDtcbiAgICAgICAgICAgIENvbnN0cnVjdG9yRnVuY3Rpb24gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgaWYgKCEodGhpcyBpbnN0YW5jZW9mIENvbnN0cnVjdG9yRnVuY3Rpb24pKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgQ29uc3RydWN0b3JGdW5jdGlvbihcImJsdWJcIiwgYXJndW1lbnRzKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuaW5pdCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA9PSAyICYmIGFyZ3VtZW50c1swXSA9PT0gXCJibHViXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaW5pdC5hcHBseSh0aGlzLCBhcmd1bWVudHNbMV0pO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5pbml0LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgQ29uc3RydWN0b3JGdW5jdGlvbi5kZXJpdmUgPSBmdW5jdGlvbiAocHJvdG90eXBlKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG1vZHVsZS5kZWZpbmVEZXJpdmVkQ2xhc3ModGhpcywgcHJvdG90eXBlKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICByZXR1cm4gQ29uc3RydWN0b3JGdW5jdGlvbjtcbiAgICAgICAgfSxcblxuICAgICAgICBkZWZpbmVDbGFzczogZnVuY3Rpb24gKHByb3RvdHlwZSkge1xuICAgICAgICAgICAgdmFyIENscyA9IG1vZHVsZS5fZ2VuZXJhdGVDb25zdHJ1Y3RvckZ1bmN0aW9uKCk7XG4gICAgICAgICAgICBDbHMucHJvdG90eXBlID0gcHJvdG90eXBlO1xuICAgICAgICAgICAgQ2xzLnByb3RvdHlwZS5jb25zdHJ1Y3RvciA9IENscztcbiAgICAgICAgICAgIHJldHVybiBDbHM7XG4gICAgICAgIH0sXG5cbiAgICAgICAgZGVmaW5lRGVyaXZlZENsYXNzOiBmdW5jdGlvbiAocGFyZW50Q2xhc3MsIHByb3RvdHlwZSkge1xuICAgICAgICAgICAgdmFyIENscyA9IG1vZHVsZS5fZ2VuZXJhdGVDb25zdHJ1Y3RvckZ1bmN0aW9uKCk7XG4gICAgICAgICAgICBDbHMucHJvdG90eXBlID0gbW9kdWxlLmV4dGVuZChtb2R1bGUub2JqZWN0KHBhcmVudENsYXNzLnByb3RvdHlwZSksIHByb3RvdHlwZSk7XG4gICAgICAgICAgICBDbHMucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gQ2xzO1xuICAgICAgICAgICAgcmV0dXJuIENscztcbiAgICAgICAgfSxcblxuICAgICAgICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gICAgICAgIC8vIHR5cGUgaGVscGVyc1xuICAgICAgICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbiAgICAgICAgZ2V0VHlwZTogZnVuY3Rpb24gKG9iaikge1xuICAgICAgICAgICAgaWYgKHR5cGVvZiAob2JqKSA9PT0gJ2Z1bmN0aW9uJykgcmV0dXJuICdmdW5jdGlvbic7XG4gICAgICAgICAgICBpZiAodHlwZW9mIChvYmopID09PSAnc3RyaW5nJykgcmV0dXJuICdzaW1wbGUnO1xuICAgICAgICAgICAgaWYgKHR5cGVvZiAob2JqKSA9PT0gJ251bWJlcicpIHJldHVybiAnc2ltcGxlJztcbiAgICAgICAgICAgIGlmICh0eXBlb2YgKG9iaikgPT09ICdib29sZWFuJykgcmV0dXJuICdzaW1wbGUnO1xuICAgICAgICAgICAgaWYgKHR5cGVvZiAob2JqKSA9PT0gJ29iamVjdCcpIHtcbiAgICAgICAgICAgICAgICBpZiAoT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKG9iaikgPT09ICdbb2JqZWN0IEFycmF5XScpIHJldHVybiAnbGlzdCc7XG4gICAgICAgICAgICAgICAgcmV0dXJuICdvYmplY3QnO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhyb3cgXCJOb3Qgc3VwcG9ydGVkIHR5cGU6XCIgKyB0eXBlb2YgKG9iaik7XG4gICAgICAgIH0sXG5cbiAgICAgICAgaXNMaXN0OiBmdW5jdGlvbiAob2JqKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5nZXRUeXBlKG9iaikgPT09ICdsaXN0JztcbiAgICAgICAgfSxcblxuICAgICAgICBpc09iamVjdDogZnVuY3Rpb24gKG9iaikge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0VHlwZShvYmopID09PSAnb2JqZWN0JztcbiAgICAgICAgfSxcblxuICAgICAgICBpc0Z1bmN0aW9uOiBmdW5jdGlvbiAob2JqKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5nZXRUeXBlKG9iaikgPT09ICdmdW5jdGlvbic7XG4gICAgICAgIH0sXG5cbiAgICAgICAgaXNTdHJpbmc6IGZ1bmN0aW9uIChvYmopIHtcbiAgICAgICAgICAgIHJldHVybiB0eXBlb2Ygb2JqID09PSAnc3RyaW5nJztcbiAgICAgICAgfSxcblxuICAgICAgICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gICAgICAgIC8vIGxpc3QgaGVscGVyc1xuICAgICAgICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbiAgICAgICAgaGFzT2JqZWN0OiBmdW5jdGlvbiAobGlzdCwgb2JqKSB7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxpc3QubGVuZ3RoOyArK2kpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGVzdE9iaiA9IGxpc3RbaV07XG4gICAgICAgICAgICAgICAgaWYgKHRlc3RPYmogPT09IG9iaikge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH0sXG5cbiAgICAgICAgcmVtb3ZlT2JqZWN0OiBmdW5jdGlvbiAobGlzdCwgb2JqKSB7XG4gICAgICAgICAgICB2YXIgbnVtRGVsID0gMDtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGlzdC5sZW5ndGg7ICsraSkge1xuICAgICAgICAgICAgICAgIHZhciB0ZXN0T2JqID0gbGlzdFtpXTtcbiAgICAgICAgICAgICAgICBpZiAodGVzdE9iaiA9PT0gb2JqKSB7XG4gICAgICAgICAgICAgICAgICAgIG51bURlbCsrO1xuICAgICAgICAgICAgICAgICAgICBsaXN0LnNwbGljZShpLCAxKTtcbiAgICAgICAgICAgICAgICAgICAgaS0tO1xuICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gbnVtRGVsO1xuICAgICAgICB9LFxuXG4gICAgICAgIHNwbGljZTogZnVuY3Rpb24gKGxpc3QsIGluZGV4LCBudW1EZWwsIGluc2VydHMpIHtcbiAgICAgICAgICAgIHZhciBhcmdzID0gW107XG4gICAgICAgICAgICBhcmdzLnB1c2goaW5kZXgsIG51bURlbCk7XG4gICAgICAgICAgICBpZiAoaW5zZXJ0cykge1xuICAgICAgICAgICAgICAgIGFyZ3MucHVzaC5hcHBseShhcmdzLCBpbnNlcnRzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGxpc3Quc3BsaWNlLmFwcGx5KGxpc3QsIGFyZ3MpO1xuICAgICAgICB9LFxuXG4gICAgICAgIHJlbW92ZUFsbDogZnVuY3Rpb24gKGxpc3QpIHtcbiAgICAgICAgICAgIG1vZHVsZS5zcGxpY2UobGlzdCwgMCwgbGlzdC5sZW5ndGgpO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgICAgICAgLy8gb2JqZWN0IGhlbHBlcnNcbiAgICAgICAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG4gICAgICAgIGV4dGVuZDogZnVuY3Rpb24gKG9iajEsIG9iajIpIHtcbiAgICAgICAgICAgIGZvciAodmFyIHByb3BlcnR5TmFtZSBpbiBvYmoyKSB7XG4gICAgICAgICAgICAgICAgb2JqMVtwcm9wZXJ0eU5hbWVdID0gb2JqMltwcm9wZXJ0eU5hbWVdO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIG9iajE7XG4gICAgICAgIH0sXG5cbiAgICAgICAgY2xvbmVFeHRlbmQ6IGZ1bmN0aW9uIChvYmoxLCBvYmoyKSB7XG4gICAgICAgICAgICB2YXIgY2xvbmUgPSB0aGlzLmV4dGVuZCh7fSwgb2JqMSk7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5leHRlbmQoY2xvbmUsIG9iajIpO1xuICAgICAgICB9LFxuXG4gICAgICAgIGlzRW1wdHk6IGZ1bmN0aW9uIChvYmopIHtcbiAgICAgICAgICAgIGZvciAodmFyIHByb3AgaW4gb2JqKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH0sXG5cbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAob2JqLCBrZXksIGRlZmF1bHRHZW5lcmF0b3IpIHtcbiAgICAgICAgICAgIHZhciB2YWx1ZSA9IG9ialtrZXldO1xuICAgICAgICAgICAgaWYgKHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHZhbHVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFsdWUgPSBkZWZhdWx0R2VuZXJhdG9yKCk7XG4gICAgICAgICAgICBvYmpba2V5XSA9IHZhbHVlO1xuICAgICAgICAgICAgcmV0dXJuIHZhbHVlO1xuICAgICAgICB9LFxuXG4gICAgICAgIGRlZmF1bHRMaXN0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gW107XG4gICAgICAgIH0sXG5cbiAgICAgICAgZGVmYXVsdE9iamVjdDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHt9O1xuICAgICAgICB9LFxuXG4gICAgICAgIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgICAgICAgLy8gaWQgZ2VuZXJhdGlvblxuICAgICAgICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbiAgICAgICAgZ2VuZXJhdGVJZDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuICcjJyArICgrK21heElkKTtcbiAgICAgICAgfSxcblxuICAgICAgICBhcmd1bWVudHNUb0xpc3Q6IGZ1bmN0aW9uIChhcmdzKSB7XG4gICAgICAgICAgICByZXR1cm4gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJncyk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICAgICAgICAvLyBvdGhlcnNcbiAgICAgICAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG4gICAgICAgIHJlbVRvUGl4ZWxzOiBmdW5jdGlvbiAocmVtKSB7XG4gICAgICAgICAgICByZXR1cm4gcmVtICogcGFyc2VGbG9hdChnZXRDb21wdXRlZFN0eWxlKGRvY3VtZW50LmRvY3VtZW50RWxlbWVudCkuZm9udFNpemUpO1xuICAgICAgICB9XG4gICAgfTtcblxuICAgIHJldHVybiBtb2R1bGU7XG5cbn0pO1xuXG5cbiJdfQ==